<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>reConnect - Admin Command Center</title>
    <!-- Lucide Icons Library -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --uni-blue: #3b489a;
            --uni-gold: #e1a92a;
            --bg: #f3f4f9;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --white: #ffffff;
            --border-color: #e2e8f0;
            --danger-color: #ef4444;
            --success-color: #22c55e;
            --card-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --header-height: 72px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', -apple-system, sans-serif; }
        body { background-color: var(--bg); color: var(--text-main); min-height: 100vh; }

        .rc-app { min-height: 100vh; position: relative; padding-top: var(--header-height); }

        /* Fixed Header */
        .rc-header {
            position: fixed; top: 0; left: 0; right: 0; height: var(--header-height);
            z-index: 2000; background: var(--uni-blue); color: white;
            padding: 0 2rem; display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .rc-logo-btn { background: none; border: none; cursor: pointer; display: flex; align-items: center; color: white; text-decoration: none; }
        .rc-logo-text { font-size: 1.8rem; font-weight: 900; letter-spacing: -1.5px; }
        .rc-logo-text span { color: var(--uni-gold); }

        /* Sliding Navigation Overlay */
        .rc-nav-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 90px;
            background: white; z-index: 3000; border-bottom: 4px solid var(--uni-gold);
            display: flex; align-items: center; padding: 0 2rem;
            transform: translateX(-100%); transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: var(--card-shadow);
        }
        .rc-nav-overlay.open { transform: translateX(0); }
        .rc-nav-list { display: flex; gap: 0.5rem; overflow-x: auto; padding: 0.5rem; scrollbar-width: none; flex: 1; align-items: center; }
        .rc-nav-link { display: flex; align-items: center; gap: 0.5rem; padding: 0.6rem 1.1rem; border-radius: 100px; font-weight: 600; color: var(--text-muted); transition: 0.2s; text-decoration: none; font-size: 0.9rem; white-space: nowrap; cursor: pointer; }
        .rc-nav-link:hover { background: #f1f5f9; color: var(--uni-blue); }
        .rc-nav-link.active { background: var(--uni-blue); color: white; }

        /* Admin Grid Layout */
        .rc-admin-container { max-width: 1200px; margin: 2rem auto; padding: 0 1.5rem; }

        .rc-page-header { margin-bottom: 2.5rem; text-align: left; }
        .rc-page-header h1 { font-size: 2.2rem; font-weight: 900; color: var(--uni-blue); margin-bottom: 0.5rem; }
        .rc-page-header p { color: var(--text-muted); font-weight: 600; font-size: 1.1rem; }

        /* Card components */
        .rc-card { background: white; border-radius: 24px; border: 1px solid var(--border-color); padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .rc-card-title { font-weight: 900; color: var(--uni-blue); margin-bottom: 1.5rem; font-size: 1.1rem; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid #f1f5f9; padding-bottom: 1rem; }

        /* Form Controls */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
        .form-group { margin-bottom: 1.5rem; }
        .form-label { display: block; font-size: 0.75rem; font-weight: 800; color: var(--text-muted); text-transform: uppercase; margin-bottom: 8px; letter-spacing: 0.5px; }
        .form-control { width: 100%; padding: 12px 16px; border-radius: 12px; border: 1.5px solid var(--border-color); background: #fcfdfe; font-weight: 600; font-size: 1rem; outline: none; transition: 0.2s; }
        .form-control:focus { border-color: var(--uni-gold); box-shadow: 0 0 0 4px rgba(225, 169, 42, 0.1); }
        textarea.form-control { resize: none; min-height: 100px; }

        /* Buttons */
        .rc-btn { padding: 12px 24px; border-radius: 12px; font-weight: 800; border: none; cursor: pointer; transition: 0.2s; display: inline-flex; align-items: center; gap: 8px; font-size: 0.9rem; }
        .btn-primary { background: var(--uni-blue); color: white; }
        .btn-primary:hover { background: #2d367a; transform: translateY(-1px); }
        .btn-gold { background: var(--uni-gold); color: var(--uni-blue); }
        .btn-danger { background: #fee2e2; color: #b91c1c; }
        .btn-danger:hover { background: #fecaca; }

        /* Moderation List */
        .moderation-item { display: flex; align-items: center; gap: 1.5rem; padding: 1.25rem; border-radius: 16px; border: 1px solid var(--border-color); background: #f8fafc; margin-bottom: 1rem; }
        .mod-info { flex: 1; }
        .mod-info h4 { font-size: 1rem; font-weight: 800; color: var(--uni-blue); margin-bottom: 4px; }
        .mod-info p { font-size: 0.85rem; color: var(--text-muted); font-weight: 600; }
        .mod-meta { font-size: 0.75rem; color: var(--uni-gold); font-weight: 800; text-transform: uppercase; margin-top: 4px; }

        /* Sub-navigation for sections */
        .sub-tabs { display: flex; gap: 10px; margin-bottom: 2rem; }
        .sub-tab-btn { padding: 10px 20px; border-radius: 50px; border: 2px solid var(--border-color); background: white; color: var(--text-muted); font-weight: 800; font-size: 0.8rem; cursor: pointer; transition: 0.2s; }
        .sub-tab-btn.active { background: var(--uni-blue); color: white; border-color: var(--uni-blue); }

        /* Timeline builder */
        .timeline-row { display: grid; grid-template-columns: 120px 1fr auto; gap: 1rem; margin-bottom: 1rem; background: #f1f5f9; padding: 10px; border-radius: 12px; }

        .hidden { display: none !important; }
        @media (max-width: 768px) { .form-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="rc-app">
    <!-- Admin Navigation Overlay -->
    <nav id="navOverlay" class="rc-nav-overlay">
        <button onclick="toggleNav()" style="background: none; border: none; cursor: pointer; padding: 10px;">
            <i data-lucide="x" color="#3b489a" size="28"></i>
        </button>
        <div class="rc-nav-list">
            <button class="rc-nav-link active" onclick="switchSection('users', this)"><i data-lucide="users" size="18"></i> User Management</button>
            <button class="rc-nav-link" onclick="switchSection('announcements', this)"><i data-lucide="megaphone" size="18"></i> Announcements</button>
            <button class="rc-nav-link" onclick="switchSection('events', this)"><i data-lucide="calendar" size="18"></i> Event Manager</button>
            <button class="rc-nav-link" onclick="switchSection('moderation', this)"><i data-lucide="shield-alert" size="18"></i> Moderation Hub</button>
        </div>
        <a href="{% url 'logout' %}" style="color:var(--danger-color); text-decoration:none; font-weight:700; border-left:2px solid var(--border-color); padding-left:1.5rem; margin-left:0.5rem; display:flex; align-items:center; gap:0.5rem;">
            <i data-lucide="log-out" size="18"></i> Exit Admin
        </a>
    </nav>

    <header class="rc-header">
        <button class="rc-logo-btn" onclick="toggleNav()">
            <span class="rc-logo-text">re<span>Connect</span></span> <small style="margin-left:10px; font-weight:800; opacity:0.7;">ADMIN</small>
        </button>
        <div style="display: flex; gap: 1.25rem; align-items: center;">
            <div style="text-align: right; color: white;">
                <p style="font-weight: 800; font-size: 0.85rem;">System Admin</p>
                <p style="font-size: 0.65rem; opacity: 0.8; font-weight: 700; text-transform: uppercase;">Command Center</p>
            </div>
            <div style="width: 40px; height: 40px; border-radius: 12px; background: var(--uni-gold); display: flex; align-items: center; justify-content: center; color: var(--uni-blue);">
                <i data-lucide="user-cog" size="24"></i>
            </div>
        </div>
    </header>

    <main class="rc-admin-container">
        
        <!-- SECTION: USER MANAGEMENT -->
        <div id="section-users" class="admin-section">
            <div class="rc-page-header">
                <h1>User Onboarding</h1>
                <p>Register new alumni or students into the system.</p>
            </div>

            <div class="sub-tabs">
                <button class="sub-tab-btn active" onclick="toggleUserMode('single', this)">Single Entry</button>
                <button class="sub-tab-btn" onclick="toggleUserMode('bulk', this)">Bulk CSV Upload</button>
            </div>

            <div id="user-single-card" class="rc-card">
                <h3 class="rc-card-title"><i data-lucide="user-plus"></i> Individual Registration</h3>
                <form id="singleUserForm" class="form-grid">
                    {% csrf_token %}
                    <div class="form-group">
                        <label class="form-label">User Role</label>
                        <select class="form-control" name="role" id="userRole">
                            <option value="alumni">Alumni</option>
                            <option value="student">Student</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Enrollment Number</label>
                        <input type="text" class="form-control" name="enrollment_number" id="userEnrollment" placeholder="ENR-2024-XXXX" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" name="full_name" id="userName">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Department</label>
                        <input type="text" class="form-control" name="department" id="userDept" placeholder="e.g. CSE, IT">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Academic Year</label>
                        <input type="text" class="form-control" name="passed_out_year" id="userYear" placeholder="e.g. 2025">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Default Password</label>
                        <input type="text" class="form-control" name="password" id="userPassword" value="connect@123" readonly>
                    </div>
                    <div style="grid-column: 1/-1;">
                        <button type="button" class="rc-btn btn-primary" onclick="createSingleUser()">Create Account</button>
                        <span id="singleUserMsg" style="margin-left:1rem;font-weight:700;"></span>
                    </div>
                </form>
            </div>

            <div id="user-bulk-card" class="rc-card hidden">
                <h3 class="rc-card-title"><i data-lucide="file-up"></i> Bulk Database Import</h3>
                <form id="bulkUploadForm">
                    {% csrf_token %}
                    <div style="border: 2px dashed var(--border-color); padding: 3rem; text-align: center; border-radius: 20px; background: #f8fafc; cursor: pointer;" onclick="document.getElementById('bulkFile').click()">
                        <i data-lucide="upload-cloud" size="48" color="var(--uni-blue)" style="margin-bottom:1rem;"></i>
                        <p style="font-weight: 800; color: var(--uni-blue);" id="bulkFileName">Drop your CSV/Excel database here</p>
                        <span style="font-size: 0.8rem; color: var(--text-muted);">Columns: Enrollment No, Name, Department, Passed Year, CGPA, Status, Phone</span>
                        <input type="file" id="bulkFile" name="file" class="hidden" accept=".csv,.xlsx" onchange="document.getElementById('bulkFileName').textContent=this.files[0]?.name||'No file selected'">
                    </div>
                    <div class="form-grid" style="margin-top:1rem;">
                        <div class="form-group">
                            <label class="form-label">Default Role</label>
                            <select class="form-control" name="role" id="bulkRole">
                                <option value="alumni">Alumni</option>
                                <option value="student">Student</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Default Password</label>
                            <input type="text" class="form-control" name="default_password" value="connect@123">
                        </div>
                    </div>
                    <button type="button" class="rc-btn btn-gold" style="margin-top: 0.5rem; width: 100%;" onclick="bulkUpload()">Process File</button>
                    <div id="bulkUploadMsg" style="margin-top:1rem;font-weight:700;"></div>
                </form>
            </div>
        </div>

        <!-- SECTION: ANNOUNCEMENTS -->
        <div id="section-announcements" class="admin-section hidden">
            <div class="rc-page-header">
                <h1>Announcements</h1>
                <p>Broadcast high-priority alerts to the entire network.</p>
            </div>
            <div class="rc-card">
                <h3 class="rc-card-title"><i data-lucide="send"></i> New Broadcast</h3>
                <form id="announcementForm">
                    {% csrf_token %}
                    <div class="form-group">
                        <label class="form-label">Headline</label>
                        <input type="text" class="form-control" name="title" id="annTitle" placeholder="Important update for batch 2024..." required>
                    </div>
                    <div class="form-row form-grid">
                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <select class="form-control" name="importance" id="annImportance">
                                <option value="info">General</option>
                                <option value="urgent">Urgent</option>
                                <option value="opportunity">Opportunity</option>
                                <option value="event">Event Linked</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Display Date (Day)</label>
                            <input type="text" class="form-control" name="display_day" id="annDay" placeholder="e.g. 22">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Message Body</label>
                        <textarea class="form-control" name="body" id="annBody" required></textarea>
                    </div>
                    <button type="button" class="rc-btn btn-primary" onclick="publishAnnouncement()">Publish to Dashboard</button>
                    <span id="annMsg" style="margin-left:1rem;font-weight:700;"></span>
                </form>
            </div>
        </div>

        <!-- SECTION: EVENTS -->
        <div id="section-events" class="admin-section hidden">
            <div class="rc-page-header">
                <h1>Event Manager</h1>
                <p>Plan and list upcoming campus reunions and workshops.</p>
            </div>
            <div class="rc-card">
                <h3 class="rc-card-title"><i data-lucide="plus-circle"></i> Create Event</h3>
                <form id="eventForm">
                    {% csrf_token %}
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">Event Title</label><input type="text" class="form-control" name="title" id="evtTitle" required></div>
                        <div class="form-group"><label class="form-label">Date (e.g. OCT 24)</label><input type="text" class="form-control" name="date_display" id="evtDate"></div>
                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <select class="form-control" name="category" id="evtCategory">
                                <option value="Reunion">Reunion</option>
                                <option value="Networking">Networking</option>
                                <option value="Mentorship">Mentorship</option>
                                <option value="Placement">Placement</option>
                                <option value="Sports">Sports</option>
                                <option value="Seminar">Seminar</option>
                                <option value="Cultural">Cultural</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group"><label class="form-label">Poster URL</label><input type="text" class="form-control" name="image_url" id="evtImage"></div>
                    </div>
                    <div class="form-group"><label class="form-label">Description</label><textarea class="form-control" name="description" id="evtDesc"></textarea></div>
                    
                    <p class="form-label">Event Timeline</p>
                    <div id="timelineContainer">
                        <div class="timeline-row">
                            <input type="text" class="form-control" name="timeline_time" placeholder="09:00 AM">
                            <input type="text" class="form-control" name="timeline_activity" placeholder="Keynote Speech">
                            <button type="button" class="rc-btn btn-danger" onclick="this.parentElement.remove()">×</button>
                        </div>
                    </div>
                    <button type="button" class="rc-btn" style="background:#e2e8f0; color:var(--uni-blue); margin-bottom: 2rem;" onclick="addTimelineRow()">+ Add Slot</button>
                    
                    <button type="button" class="rc-btn btn-primary" style="width:100%;" onclick="createEvent()">Create Live Event</button>
                    <div id="evtMsg" style="margin-top:1rem;font-weight:700;"></div>
                </form>
            </div>
        </div>

        <!-- SECTION: MODERATION -->
        <div id="section-moderation" class="admin-section hidden">
            <div class="rc-page-header">
                <h1>Moderation Hub</h1>
                <p>Monitor and manage community-posted opportunities and funds.</p>
            </div>

            <div class="sub-tabs">
                <button class="sub-tab-btn active" onclick="switchModTab('fundings', this)">Funding Posts</button>
                <button class="sub-tab-btn" onclick="switchModTab('jobs', this)">Job Referrals</button>
            </div>

            <div id="mod-fundings" class="rc-card">
                <h3 class="rc-card-title"><i data-lucide="piggy-bank"></i> Active Community Grants</h3>
                <div id="fundingModList">
                    <!-- Dynamic List -->
                </div>
            </div>

            <div id="mod-jobs" class="rc-card hidden">
                <h3 class="rc-card-title"><i data-lucide="briefcase"></i> Community Referrals</h3>
                <div id="jobModList">
                    <!-- Dynamic List -->
                </div>
            </div>
        </div>

    </main>
</div>

<script>
    function getCsrf() { return document.querySelector('[name=csrfmiddlewaretoken]').value; }

    function toggleNav() { document.getElementById('navOverlay').classList.toggle('open'); }

    function switchSection(section, btn) {
        document.querySelectorAll('.rc-nav-link').forEach(l => l.classList.remove('active'));
        btn.classList.add('active');
        document.querySelectorAll('.admin-section').forEach(s => s.classList.add('hidden'));
        document.getElementById(`section-${section}`).classList.remove('hidden');
        toggleNav();
        lucide.createIcons();
    }

    function toggleUserMode(mode, btn) {
        document.querySelectorAll('.sub-tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('user-single-card').classList.add('hidden');
        document.getElementById('user-bulk-card').classList.add('hidden');
        document.getElementById(`user-${mode}-card`).classList.remove('hidden');
    }

    function switchModTab(tab, btn) {
        const parent = btn.parentElement;
        parent.querySelectorAll('.sub-tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('mod-fundings').classList.add('hidden');
        document.getElementById('mod-jobs').classList.add('hidden');
        document.getElementById(`mod-${tab}`).classList.remove('hidden');
    }

    function addTimelineRow() {
        const container = document.getElementById('timelineContainer');
        const row = document.createElement('div');
        row.className = 'timeline-row';
        row.innerHTML = `
            <input type="text" class="form-control" name="timeline_time" placeholder="Time">
            <input type="text" class="form-control" name="timeline_activity" placeholder="Activity">
            <button type="button" class="rc-btn btn-danger" onclick="this.parentElement.remove()">×</button>
        `;
        container.appendChild(row);
    }

    // ── Create Single User ──
    async function createSingleUser() {
        const form = document.getElementById('singleUserForm');
        const fd = new FormData(form);
        const msg = document.getElementById('singleUserMsg');
        msg.textContent = 'Creating...';
        msg.style.color = 'var(--uni-blue)';
        try {
            const res = await fetch('{% url "create_user" %}', { method: 'POST', body: fd });
            const data = await res.json();
            if (data.success) {
                msg.textContent = '✓ ' + data.message;
                msg.style.color = 'var(--success-color)';
                form.reset();
            } else {
                msg.textContent = '✗ ' + (data.error || 'Error');
                msg.style.color = 'var(--danger-color)';
            }
        } catch(e) {
            msg.textContent = '✗ Network error';
            msg.style.color = 'var(--danger-color)';
        }
    }

    // ── Bulk Upload ──
    async function bulkUpload() {
        const form = document.getElementById('bulkUploadForm');
        const fd = new FormData(form);
        const msg = document.getElementById('bulkUploadMsg');
        if (!document.getElementById('bulkFile').files.length) {
            msg.textContent = '✗ Please select a file first';
            msg.style.color = 'var(--danger-color)';
            return;
        }
        msg.textContent = 'Processing...';
        msg.style.color = 'var(--uni-blue)';
        try {
            const res = await fetch('{% url "bulk_upload" %}', { method: 'POST', body: fd });
            const data = await res.json();
            if (data.error) {
                msg.innerHTML = `<span style="color:var(--danger-color)">✗ ${data.error}</span>`;
            } else {
                msg.innerHTML = `<span style="color:var(--success-color)">✓ Created: ${data.created}</span> | Skipped: ${data.skipped}`;
                if (data.errors && data.errors.length) {
                    msg.innerHTML += `<br><small style="color:var(--text-muted)">${data.errors.slice(0,5).join('<br>')}</small>`;
                }
            }
        } catch(e) {
            msg.textContent = '✗ Network error';
            msg.style.color = 'var(--danger-color)';
        }
    }

    // ── Publish Announcement ──
    async function publishAnnouncement() {
        const form = document.getElementById('announcementForm');
        const fd = new FormData(form);
        // Auto-set display month to current
        const now = new Date();
        fd.set('display_month', now.toLocaleString('en', {month:'short'}));
        if (!fd.get('display_day')) fd.set('display_day', String(now.getDate()));
        const msg = document.getElementById('annMsg');
        msg.textContent = 'Publishing...';
        try {
            const res = await fetch('{% url "create_announcement" %}', { method: 'POST', body: fd });
            const data = await res.json();
            if (data.success) {
                msg.textContent = '✓ ' + data.message;
                msg.style.color = 'var(--success-color)';
                form.reset();
            } else {
                msg.textContent = '✗ ' + (data.error || 'Error');
                msg.style.color = 'var(--danger-color)';
            }
        } catch(e) {
            msg.textContent = '✗ Network error';
            msg.style.color = 'var(--danger-color)';
        }
    }

    // ── Create Event ──
    async function createEvent() {
        const form = document.getElementById('eventForm');
        const fd = new FormData(form);
        const msg = document.getElementById('evtMsg');
        msg.textContent = 'Creating...';
        try {
            const res = await fetch('{% url "create_event" %}', { method: 'POST', body: fd });
            const data = await res.json();
            if (data.success) {
                msg.innerHTML = `<span style="color:var(--success-color)">✓ ${data.message}</span>`;
                form.reset();
                document.getElementById('timelineContainer').innerHTML = `
                    <div class="timeline-row">
                        <input type="text" class="form-control" name="timeline_time" placeholder="09:00 AM">
                        <input type="text" class="form-control" name="timeline_activity" placeholder="Keynote Speech">
                        <button type="button" class="rc-btn btn-danger" onclick="this.parentElement.remove()">×</button>
                    </div>`;
            } else {
                msg.innerHTML = `<span style="color:var(--danger-color)">✗ ${data.error || 'Error'}</span>`;
            }
        } catch(e) {
            msg.innerHTML = '<span style="color:var(--danger-color)">✗ Network error</span>';
        }
    }

    // ── Moderation: load real posts ──
    async function renderModeration() {
        try {
            // Load funding posts
            const postsRes = await fetch('{% url "api_posts_list" %}');
            const postsData = await postsRes.json();
            const fundings = (postsData.posts || []).filter(p => p.post_type === 'funding');
            const hirings = (postsData.posts || []).filter(p => p.post_type === 'hiring');

            document.getElementById('fundingModList').innerHTML = fundings.length ? fundings.map(f => `
                <div class="moderation-item" id="fund-${f.id}">
                    <div class="mod-info">
                        <h4>${f.title}</h4>
                        <p>Posted by ${f.author_name} • ${f.created_at}</p>
                        <div class="mod-meta">Target Amount: ${f.amount || 'N/A'}</div>
                    </div>
                    <button class="rc-btn btn-danger" onclick="deleteModPost(${f.id}, 'fund-${f.id}')">
                        <i data-lucide="trash-2" size="16"></i> Delete
                    </button>
                </div>
            `).join('') : '<p style="color:var(--text-muted);font-weight:600;">No funding posts yet.</p>';

            document.getElementById('jobModList').innerHTML = hirings.length ? hirings.map(j => `
                <div class="moderation-item" id="job-${j.id}">
                    <div class="mod-info">
                        <h4>${j.role || j.title} ${j.company ? '@ '+j.company : ''}</h4>
                        <p>Shared by ${j.author_name} • ${j.job_type || 'Job'}</p>
                    </div>
                    <button class="rc-btn btn-danger" onclick="deleteModPost(${j.id}, 'job-${j.id}')">
                        <i data-lucide="trash-2" size="16"></i> Delete
                    </button>
                </div>
            `).join('') : '<p style="color:var(--text-muted);font-weight:600;">No job posts yet.</p>';

            lucide.createIcons();
        } catch(e) {
            console.error('Failed to load moderation data:', e);
        }
    }

    async function deleteModPost(postId, elementId) {
        if(!confirm('Are you sure you want to delete this community post?')) return;
        // For now, just remove from DOM (could add a delete API for posts)
        document.getElementById(elementId)?.remove();
    }

    window.onload = () => {
        renderModeration();
        lucide.createIcons();
    };
</script>

</body>
</html>